SET(LIB_NAME osgdb_verse_odbc)
SET(LIBRARY_FILES
    ReaderWriterODBC.cpp
)

#########################################
IF(NOT USE_WASM_OPTIONS)
    IF(WIN32)
        ADD_DEFINITIONS(-DUSE_ODBC_API)
    ELSE(WIN32)
        # sudo apt-install unixodbc-dev
        FIND_DEPENDENCE(ODBC "sql.h" "libodbc.so" "")
        IF(ODBC_FOUND)
            ADD_DEFINITIONS(-DUSE_ODBC_API)
        ENDIF(ODBC_FOUND)
    ENDIF(WIN32)
ENDIF(NOT USE_WASM_OPTIONS)

SET_PROPERTY(GLOBAL APPEND PROPERTY VERSE_PLUGIN_LIBRARIES "${LIB_NAME}")
IF(VERSE_STATIC_BUILD)
    NEW_PLUGIN(${LIB_NAME} STATIC)
ELSE()
    NEW_PLUGIN(${LIB_NAME} SHARED)
ENDIF()

SET_PROPERTY(TARGET ${LIB_NAME} PROPERTY FOLDER "PLUGINS")
TARGET_COMPILE_OPTIONS(${LIB_NAME} PUBLIC -D_SCL_SECURE_NO_WARNINGS)
TARGET_LINK_LIBRARIES(${LIB_NAME} osgVerseDependency osgVerseReaderWriter)
LINK_OSG_LIBRARY(${LIB_NAME} OpenThreads osg osgDB osgUtil)
IF(ODBC_FOUND)
    IF(WIN32)
        TARGET_LINK_LIBRARIES(${LIB_NAME} odbc32)
    ELSE(WIN32)
        TARGET_LINK_LIBRARIES(${LIB_NAME} odbc)
    ENDIF(WIN32)
ENDIF()

INSTALL(TARGETS ${LIB_NAME} EXPORT ${LIB_NAME}
        RUNTIME DESTINATION ${INSTALL_PLUGINDIR} COMPONENT libosgverse
        LIBRARY DESTINATION ${INSTALL_LIBDIR} COMPONENT libosgverse
        ARCHIVE DESTINATION ${INSTALL_ARCHIVEDIR} COMPONENT libosgverse-dev)
IF(NOT VERSE_STATIC_BUILD)
    IF(MSVC AND VERSE_INSTALL_PDB_FILES)
        INSTALL(FILES $<TARGET_PDB_FILE:${LIB_NAME}> DESTINATION ${INSTALL_PLUGINDIR} OPTIONAL)
    ENDIF()
ENDIF()

